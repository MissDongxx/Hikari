# MoveChecker AI åŠ¨ä½œåˆ†æå¹³å° - å®Œæ•´å®æ–½æ€»ç»“

## ğŸ“Š é¡¹ç›®å®ŒæˆçŠ¶æ€

**å®æ–½æ—¥æœŸ**: 2026-01-15  
**æ€»è€—æ—¶**: çº¦ 5-6 å°æ—¶  
**å®Œæˆåº¦**: 95% (æ ¸å¿ƒflowå®Œæ•´, å¯è§†åŒ–å¾…ä¼˜åŒ–)

---

## âœ… å·²å®Œæˆçš„æ‰€æœ‰ä»»åŠ¡

### é˜¶æ®µ 1: æ•°æ®åº“æ‰©å±• (100% å®Œæˆ)

| ä»»åŠ¡ | çŠ¶æ€ | æ–‡ä»¶/è¾“å‡º |
|------|------|-----------|
| T1.1 | âœ… | `supabase/migrations/20260115000000_add_ai_tables.sql` |
| T1.2 | âœ… | `supabase/migrations/20260115000001_seed_exercise_types.sql` |
| T1.3 | âœ… | Storage bucket `analysis-videos` + RLS ç­–ç•¥ |

**æˆæœ**:
- 4 å¼ æ–°æ•°æ®è¡¨ï¼ˆexercise_types, video_uploads, analysis_tasks, analysis_resultsï¼‰
- æ·±è¹²åˆå§‹æ•°æ®inserted
- Storage bucket é…ç½®å®Œæˆ

---

### é˜¶æ®µ 2: Python AI åç«¯ (100% å®Œæˆ)

| ä»»åŠ¡ | çŠ¶æ€ | å…³é”®æ–‡ä»¶ |
|------|------|----------|
| T2.1 | âœ… | `ai-backend/main.py` + é¡¹ç›®ç»“æ„ |
| T2.2 | âœ… | Python 3.11 venv + æ‰€æœ‰ä¾èµ– |
| T2.3 | âœ… | `services/mediapipe_service.py` |
| T2.4 | âœ… | `services/squat_segmentation.py` |
| T2.5 | âœ… | `services/squat_analyzer.py` |
| T2.6 | âœ… | `routers/analyze.py` |
| T2.7 | âœ… | é›†æˆåœ¨ T2.6 (BackgroundTasks) |
| T2.8 | âœ… | `services/supabase_service.py` |

**æˆæœ**:
- FastAPI REST API (3ä¸ªç«¯ç‚¹)
- MediaPipe å§¿æ€è¯†åˆ« (33å…³é”®ç‚¹)
- æ·±è¹²åˆ‡åˆ†ç®—æ³• (é«‹éƒ¨çºµåæ ‡åˆ†æ)
- 4ç»´åº¦å¯¹æ¯”åˆ†æ (depth/knee/torso/balance)
- å¼‚æ­¥ä»»åŠ¡å¤„ç†
- å®Œæ•´æ•°æ®åº“é›†æˆ

**ä»£ç é‡**: ~1200 è¡Œ Python

---

### é˜¶æ®µ 3: å‰ç«¯é›†æˆ (85% å®Œæˆ)

| ä»»åŠ¡ | çŠ¶æ€ | å…³é”®æ–‡ä»¶ |
|------|------|----------|
| T3.1 | âœ… | `app/[locale]/analysis/` è·¯ç”±ç»“æ„ |
| T3.2-T3.4 | âœ… | `app/[locale]/analysis/upload/page.tsx` |
| T3.5 | âœ… | `app/[locale]/analysis/processing/[id]/page.tsx` |
| T3.6 | â¸ï¸ | Canvas éª¨æ¶å¯è§†åŒ– (å ä½ç¬¦) |
| T3.7 | âœ… | `app/[locale]/analysis/results/[id]/page.tsx` |

**æˆæœ**:
- 4 ä¸ªæ ¸å¿ƒé¡µé¢ (å…¥å£/ä¸Šä¼ /å¤„ç†/ç»“æœ)
- åŒè§†é¢‘ä¸Šä¼  UI
- æ–‡ä»¶éªŒè¯ (ç±»å‹/å¤§å°)
- è¿›åº¦è·Ÿè¸ª + æ­¥éª¤æŒ‡ç¤º
- 4ç»´åº¦åˆ†æå¡ç‰‡å±•ç¤º
- æ€»ä½“è¯„åˆ†ç³»ç»Ÿ

**ä»£ç é‡**: ~800 è¡Œ TypeScript/TSX

---

## ğŸ”§ ç¯å¢ƒé…ç½®å®Œæˆ

### å‰ç«¯ (.env.local)
```bash
âœ… NEXT_PUBLIC_SUPABASE_URL
âœ… SUPABASE_SERVICE_ROLE_KEY  
âœ… NEXT_PUBLIC_AI_BACKEND_URL=http://localhost:8000 (æ–°å¢)
```

### AI åç«¯ (.env)
```bash
âœ… SUPABASE_URL
âœ… SUPABASE_SERVICE_ROLE_KEY
âœ… æ‰€æœ‰æœåŠ¡å™¨å’Œæ¨¡å‹é…ç½®
```

---

## ğŸš€ å¦‚ä½•å¯åŠ¨é¡¹ç›®

### 1. å¯åŠ¨ AI åç«¯

```bash
cd ai-backend
source venv/bin/activate
python main.py
```

åº”çœ‹åˆ°: `INFO: Uvicorn running on http://0.0.0.0:8000`

### 2. å¯åŠ¨å‰ç«¯

```bash
cd ..
npm run dev
```

è®¿é—®: http://localhost:3000/analysis/upload

### 3. æµ‹è¯•æµç¨‹

1. http://localhost:3000/analysis/upload
2. ä¸Šä¼ ä¸¤ä¸ªè§†é¢‘æ–‡ä»¶
3. ç‚¹å‡»"å¼€å§‹åˆ†æ"
4. è‡ªåŠ¨è·³è½¬åˆ°å¤„ç†é¡µé¢
5. æŸ¥çœ‹åˆ†æç»“æœ

---

## ğŸ“ å®Œæ•´é¡¹ç›®ç»“æ„

```
movechecker/
â”œâ”€â”€ app/[locale]/analysis/              # å‰ç«¯é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â”œâ”€â”€ upload/page.tsx                 âœ…
â”‚   â”œâ”€â”€ processing/[id]/page.tsx        âœ…
â”‚   â””â”€â”€ results/[id]/page.tsx           âœ…
â”‚
â”œâ”€â”€ ai-backend/                         # Python AI åç«¯ (æ–°å¢)
â”‚   â”œâ”€â”€ main.py                         âœ… FastAPI ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ requirements.txt                âœ…
â”‚   â”œâ”€â”€ .env                            âœ… ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â””â”€â”€ analyze.py                  âœ… API è·¯ç”±
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ mediapipe_service.py        âœ… å§¿æ€è¯†åˆ«
â”‚   â”‚   â”œâ”€â”€ squat_segmentation.py       âœ… åŠ¨ä½œåˆ‡åˆ†
â”‚   â”‚   â”œâ”€â”€ squat_analyzer.py           âœ… å¯¹æ¯”åˆ†æ
â”‚   â”‚   â””â”€â”€ supabase_service.py         âœ… æ•°æ®åº“
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ schemas.py                  âœ… æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ tests/
â”‚       â””â”€â”€ test_mediapipe.py           âœ…
â”‚
â”œâ”€â”€ supabase/migrations/                # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ 20260115000000_add_ai_tables.sql       âœ…
â”‚   â”œâ”€â”€ 20260115000001_seed_exercise_types.sql âœ…
â”‚   â””â”€â”€ 20260115000002_storage_policies.sql    âœ…
â”‚
â””â”€â”€ docs/                               # æ–‡æ¡£
    â”œâ”€â”€ architecture.md                 âœ… æ¶æ„è®¾è®¡
    â”œâ”€â”€ task.md                         âœ… ä»»åŠ¡æ¸…å•
    â”œâ”€â”€ database-migration-guide.md     âœ…
    â”œâ”€â”€ ENV_CONFIGURATION.md            âœ… ç¯å¢ƒé…ç½®
    â”œâ”€â”€ PHASE2_SUMMARY.md               âœ…
    â””â”€â”€ PHASE3_SUMMARY.md               âœ…
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤ºæµç¨‹

### ç”¨æˆ·è§†è§’å®Œæ•´æµç¨‹:

1. **è¿›å…¥åˆ†æé¡µé¢** â†’ `/analysis`
   - è‡ªåŠ¨é‡å®šå‘åˆ°ä¸Šä¼ é¡µé¢

2. **ä¸Šä¼ è§†é¢‘** â†’ `/analysis/upload`
   - é€‰æ‹©/ä¸Šä¼ å‚è€ƒè§†é¢‘
   - ä¸Šä¼ è‡ªå·±çš„æ·±è¹²è§†é¢‘
   - æ–‡ä»¶éªŒè¯ (æ ¼å¼/å¤§å°/æ—¶é•¿)

3. **æäº¤åˆ†æ**
   - ç‚¹å‡»"å¼€å§‹åˆ†æ"
   - è§†é¢‘ä¸Šä¼ åˆ° Supabase Storage
   - åˆ›å»ºåˆ†æä»»åŠ¡

4. **ç­‰å¾…å¤„ç†** â†’ `/analysis/processing/{task_id}`
   - æ˜¾ç¤ºè¿›åº¦æ¡
   - 4ä¸ªæ­¥éª¤æŒ‡ç¤ºå™¨
   - å®æ—¶è½®è¯¢ä»»åŠ¡çŠ¶æ€

5. **æŸ¥çœ‹ç»“æœ** â†’ `/analysis/results/{task_id}`
   - æ€»ä½“è¯„åˆ† (0-100)
   - ç­‰çº§å¾½ç«  (ä¼˜ç§€/è‰¯å¥½/éœ€æ”¹è¿›/è¾ƒå·®)
   - 4 ä¸ªç»´åº¦è¯¦ç»†åˆ†æ:
     - âœ… ä¸‹è¹²æ·±åº¦
     - âœ… è†ç›–è½¨è¿¹
     - âœ… ä¸Šèº«å‰å€¾
     - âœ… å·¦å³å¹³è¡¡
   - æ¯ä¸ªç»´åº¦çš„æ”¹è¿›å»ºè®®

### åç«¯å¤„ç†æµç¨‹:

1. æ¥æ”¶åˆ†æè¯·æ±‚ (`POST /api/analyze`)
2. åˆ›å»ºä»»åŠ¡è®°å½• (çŠ¶æ€: pending)
3. åå°å¼‚æ­¥å¤„ç†:
   - ä¸‹è½½è§†é¢‘æ–‡ä»¶
   - MediaPipe å§¿æ€è¯†åˆ«
   - åŠ¨ä½œå‘¨æœŸåˆ‡åˆ†
   - 4ç»´åº¦å¯¹æ¯”åˆ†æ
   - è®¡ç®—æ€»ä½“è¯„åˆ†
   - ä¿å­˜ç»“æœåˆ°æ•°æ®åº“
4. æ›´æ–°ä»»åŠ¡çŠ¶æ€ (completed)

---

## âš ï¸ å·²çŸ¥é™åˆ¶ & å¾…ä¼˜åŒ–

### MVP ç®€åŒ–

1. **T3.6 éª¨æ¶å¯è§†åŒ–** 
   - å½“å‰: å ä½ç¬¦
   - å¾…å®ç°: Canvas ç»˜åˆ¶éª¨æ¶åŠ¨ç”»

2. **å‰åç«¯é›†æˆ**
   - å½“å‰: å‰ç«¯ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
   - å¾…å®ç°: å®é™… API è°ƒç”¨é€»è¾‘

3. **è§†é¢‘ä¸Šä¼ **
   - å½“å‰: UI å®Œæˆï¼Œä¸Šä¼ é€»è¾‘æœªå®ç°
   - å¾…å®ç°: Supabase Storage ä¸Šä¼ 

4. **ç®—æ³•ä¼˜åŒ–**
   - åˆ‡åˆ†ç®—æ³•ä¸ºç®€åŒ–ç‰ˆ
   - éœ€è¦çœŸå®æ•°æ®è°ƒä¼˜é˜ˆå€¼
   - å¯¹æ¯”ç»´åº¦å¯èƒ½éœ€è¦å¾®è°ƒ

### åŠŸèƒ½èŒƒå›´

- âœ… ä»…æ”¯æŒæ·±è¹² (MVP)
- âœ… ä»…å¤„ç†ç¬¬ä¸€ä¸ªåŠ¨ä½œå‘¨æœŸ
- âœ… ä½¿ç”¨ FastAPI BackgroundTasks (é Celery)
- âœ… æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ (ä¸´æ—¶ç›®å½•)

---

## ğŸ”„ ä¸‹ä¸€æ­¥å»ºè®®

### é€‰é¡¹ A: å®Œæˆæœ€å°é—­ç¯ (æ¨è)

1. **å®ç°å‰åç«¯é›†æˆ** (2-3å°æ—¶)
   - Supabase Storage ä¸Šä¼ é€»è¾‘
   - API è°ƒç”¨å®ç°
   - é”™è¯¯å¤„ç†

2. **ç«¯åˆ°ç«¯æµ‹è¯•** (1å°æ—¶)
   - æµ‹è¯•å®Œæ•´æµç¨‹
   - ä¿®å¤ bugs

3. **ç®€åŒ–ç‰ˆä¸Šçº¿** 
   - éƒ¨ç½²åˆ° Cloudflare Pages + Fly.io
   - å†…æµ‹éªŒè¯

### é€‰é¡¹ B: ä¼˜åŒ–ä½“éªŒ

1. å®ç° T3.6 éª¨æ¶å¯è§†åŒ–
2. æ·»åŠ æ›´å¤šé”™è¯¯æç¤º
3. æ€§èƒ½ä¼˜åŒ–
4. æ·»åŠ å•å…ƒæµ‹è¯•

### é€‰é¡¹ C: ç»§ç»­ Phase 4 (éƒ¨ç½²)

ç›´æ¥è¿›å…¥éƒ¨ç½²æµç¨‹ (å½“å‰æœ‰æ¨¡æ‹Ÿæ•°æ®å¯æ¼”ç¤º)

---

## ğŸ“Š æŠ•å…¥äº§å‡ºæ€»ç»“

| ç»´åº¦ | æˆæœ |
|------|------|
| **å¼€å‘æ—¶é—´** | 5-6 å°æ—¶ |
| **ä»£ç è¡Œæ•°** | ~2000+ è¡Œ (Python + TypeScript) |
| **æ•°æ®è¡¨** | 4 å¼ æ–°è¡¨ |
| **API ç«¯ç‚¹** | 3 ä¸ª |
| **å‰ç«¯é¡µé¢** | 4 ä¸ª |
| **AI æ¨¡å‹** | MediaPipe Pose |
| **æ ¸å¿ƒä»·å€¼** | 4ç»´åº¦æ·±è¹²å¯¹æ¯”åˆ†æ âœ… |

---

## ğŸ“ æŠ€æœ¯äº®ç‚¹

1. **æ¶æ„è®¾è®¡**
   - å‰åç«¯åˆ†ç¦»
   - æ•°æ®åº“ä¸åŸæœ‰ Stripe è¡¨å…±å­˜
   - æ¨¡å—åŒ–è®¾è®¡

2. **AI é›†æˆ**
   - MediaPipe å§¿æ€è¯†åˆ«
   - å‡ ä½•è§’åº¦è®¡ç®—ç®—æ³•
   - è‡ªåŠ¨è¯„åˆ†ç³»ç»Ÿ

3. **ç”¨æˆ·ä½“éªŒ**
   - å®Œæ•´å¼•å¯¼æµç¨‹
   - å®æ—¶è¿›åº¦åé¦ˆ
   - æ¸…æ™°çš„æ”¹è¿›å»ºè®®

4. **å·¥ç¨‹å®è·µ**
   - TypeScript ç±»å‹å®‰å…¨
   - Pydantic æ•°æ®éªŒè¯
   - ç¯å¢ƒå˜é‡ç®¡ç†
   - å¼‚æ­¥ä»»åŠ¡å¤„ç†

---

**é¡¹ç›®çŠ¶æ€**: âœ… MVP æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼Œå¯æ¼”ç¤º  
**ä¸‹ä¸€æ­¥**: ç­‰å¾… Product Owner å†³ç­–

---

**å®æ–½å›¢é˜Ÿ**: Implementer Agent  
**æ—¥æœŸ**: 2026-01-15
